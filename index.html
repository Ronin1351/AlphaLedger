# Create a complete single-file HTML with:
# - Single snapshot section (no duplicate IDs)
# - Compute logic using corrected Net-Debt/EBITDA and ROIC formulas
# - Reset button that clears all inputs/outputs
# - Minimal styling close to a dark panel look
# - F-Score input so the verdict panel can reflect it
#
html = r"""<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Stock Evaluator – Clean Snapshot</title>
<style>
  :root{
    --bg:#0f1218;
    --card:#151a22;
    --muted:#1e2430;
    --text:#e7eaf0;
    --sub:#aab3c2;
    --good:#1f9d55;
    --warn:#d97706;
    --bad:#dc2626;
    --pill:#2a3344;
    --accent:#f59e0b;
    --border: #2b3446;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    background:var(--bg);
    color:var(--text);
  }
  .wrap{max-width:1200px;margin:32px auto;padding:0 16px;display:grid;grid-template-columns:1fr 1fr;gap:16px;}
  .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;box-shadow:0 10px 24px rgba(0,0,0,.25)}
  .card h2{margin:0 0 12px;font-size:18px}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .row-3{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
  .field{border:1px dashed var(--muted);border-radius:10px;padding:10px;display:flex;justify-content:space-between;align-items:center;min-height:44px}
  .label{opacity:.85}
  .out{font-weight:600}
  input[type="number"],input[type="text"]{width:100%;background:#0b0f14;border:1px solid var(--muted);color:var(--text);border-radius:10px;padding:10px}
  .pill{display:inline-flex;align-items:center;gap:8px;background:var(--pill);border-radius:24px;padding:6px 10px;margin-right:8px;font-size:12px}
  .btns{display:flex;gap:10px;flex-wrap:wrap}
  button{background:#0e1726;color:var(--text);border:1px solid var(--border);border-radius:10px;padding:10px 14px;cursor:pointer}
  button:hover{border-color:var(--accent)}
  .sub{color:var(--sub);font-size:12px}
  .good{background:rgba(31,157,85,.12);border-color:rgba(31,157,85,.35);color:#86efac}
  .bad{background:rgba(220,38,38,.10);border-color:rgba(220,38,38,.35);color:#fecaca}
  .note{border:1px dashed var(--muted);border-radius:10px;padding:12px;min-height:44px;color:var(--sub)}
  .big{font-size:20px;font-weight:700}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
  @media (max-width:980px){.wrap{grid-template-columns:1fr}.grid{grid-template-columns:1fr}}
  .kvs{display:flex;gap:8px;flex-wrap:wrap;margin:6px 0}
</style>
</head>
<body>
  <div class="wrap">
    <section class="card" id="snap">
      <h2>ROIC / Debt / Margins / Growth <span class="sub">Snapshot</span></h2>
      
      <div class="row">
        <div class="field"><span class="label">EBIT Margin</span><span id="ebitMarginOut" class="out">—</span></div>
        <div class="field"><span class="label">Net‑Debt / EBITDA</span><span id="ndebtOut" class="out">—</span></div>
      </div>

      <div class="row">
        <div class="field"><span class="label">ROIC</span><span id="roicOut" class="out">—</span></div>
        <div class="field"><span class="label">Cumulative Growth (4y)</span><span id="cumOut" class="out">—</span></div>
      </div>

      <div class="kvs">
        <span id="growthClass" class="pill">Growth Class: —</span>
        <span id="spreadPill" class="pill">Spread (ROIC – WACC): —</span>
      </div>

      <div class="row">
        <div class="field">
          <label class="label" for="wacc">WACC (%)</label>
          <input id="wacc" type="number" step="0.01" placeholder="e.g., 10">
        </div>
      </div>

      <div class="note" id="notes">Enter a WACC to see value creation or destruction.</div>
    </section>

    <section class="card">
      <h2>Composite Verdict <span class="sub">F‑Score + ROIC vs WACC + Growth</span></h2>
      <div class="field" style="margin-bottom:8px;">
        <span class="big" id="verdict">Needs inputs</span>
      </div>

      <div class="row">
        <div class="field"><span class="label">F‑Score</span><span id="fscoreOut" class="out">—</span></div>
        <div class="field"><span class="label">ROIC – WACC</span><span id="spreadOut" class="out">—</span></div>
      </div>

      <div class="row">
        <div class="field"><span class="label">Growth Class</span><span id="growthClass2" class="out">—</span></div>
        <div class="field"><span class="label">Cumulative Growth (4y)</span><span id="cumOut2" class="out">—</span></div>
      </div>

      <div class="note" id="reason">Fetch or fill fields, enter WACC, then press Compute.</div>
    </section>

    <section class="card" id="inputs">
      <h2>Inputs</h2>
      <div class="grid">
        <div>
          <div class="row-3">
            <div>
              <label class="label">Revenue (current)</label>
              <input id="rev0" type="number" step="0.01" placeholder="e.g., 2866 (USD m)">
            </div>
            <div>
              <label class="label">Revenue (4y ago)</label>
              <input id="rev4" type="number" step="0.01" placeholder="e.g., 1100">
            </div>
            <div>
              <label class="label">EBIT</label>
              <input id="ebit" type="number" step="0.01" placeholder="e.g., 310.4">
            </div>
          </div>
          <div class="row-3" style="margin-top:8px">
            <div>
              <label class="label">EBITDA</label>
              <input id="ebitda" type="number" step="0.01" placeholder="e.g., 342">
            </div>
            <div>
              <label class="label">Income Tax</label>
              <input id="tax" type="number" step="0.01" placeholder="e.g., 20">
            </div>
            <div>
              <label class="label">Cash & Equivalents</label>
              <input id="cash" type="number" step="0.01" placeholder="e.g., 5200">
            </div>
          </div>
        </div>
        <div>
          <div class="row-3">
            <div>
              <label class="label">Short‑term Debt</label>
              <input id="std" type="number" step="0.01" placeholder="0">
            </div>
            <div>
              <label class="label">Current Portion LT Debt</label>
              <input id="cpltd" type="number" step="0.01" placeholder="0">
            </div>
            <div>
              <label class="label">Long‑term Debt</label>
              <input id="ltd0" type="number" step="0.01" placeholder="0">
            </div>
          </div>
          <div class="row-3" style="margin-top:8px">
            <div>
              <label class="label">Term Debt (alt field)</label>
              <input id="termdebt" type="number" step="0.01" placeholder="0">
            </div>
            <div>
              <label class="label">Total Assets</label>
              <input id="assets0" type="number" step="0.01" placeholder="e.g., 7000">
            </div>
            <div>
              <label class="label">Current Liabilities</label>
              <input id="cl0" type="number" step="0.01" placeholder="e.g., 1400">
            </div>
          </div>
        </div>
      </div>

      <div class="btns" style="margin-top:12px">
        <button id="compute">Compute All</button>
        <button id="reset">Reset</button>
        <div class="sub">Enter numbers in USD millions or consistent units.</div>
      </div>
    </section>
  </div>

<script>
  // Helpers
  const g = id => document.getElementById(id);
  const parseNum = v => {
    if (v === null || v === undefined || v === '') return NaN;
    const x = Number(v);
    return Number.isFinite(x) ? x : NaN;
  };
  const fix = (v, p=2) => Number.isFinite(v) ? v.toFixed(p) : '—';
  const pct = v => Number.isFinite(v) ? (v).toFixed(2) + '%' : '—';

  function computeSnapshot(){
    // Inputs
    const Sales = parseNum(g('rev0').value);
    const Sales4 = parseNum(g('rev4').value);
    const EBIT = parseNum(g('ebit').value);
    const EBITDA = parseNum(g('ebitda').value);
    const tax = parseNum(g('tax').value);
    const cash = parseNum(g('cash').value);
    const std = parseNum(g('std').value);
    const cpltd = parseNum(g('cpltd').value);
    const ltd = parseNum(g('ltd0').value);
    const termd = parseNum(g('termdebt').value);
    const assets = parseNum(g('assets0').value);
    const cl = parseNum(g('cl0').value);
    const wacc = parseNum(g('wacc').value);

    // EBIT margin
    const ebitMargin = (Number.isFinite(Sales) && Sales !== 0 && Number.isFinite(EBIT)) ? (EBIT / Sales) * 100 : NaN;
    g('ebitMarginOut').textContent = pct(ebitMargin);

    // Net-debt / EBITDA  (pick one LT debt field to avoid double count)
    const longDebt = Number.isFinite(ltd) ? ltd : (Number.isFinite(termd) ? termd : 0);
    const netDebt = (Number.isFinite(std)?std:0) + (Number.isFinite(cpltd)?cpltd:0) + (Number.isFinite(longDebt)?longDebt:0) - (Number.isFinite(cash)?cash:0);
    const ndRatio = (Number.isFinite(EBITDA) && EBITDA !== 0) ? (netDebt / EBITDA) : NaN;
    g('ndebtOut').textContent = Number.isFinite(ndRatio) ? fix(ndRatio, 2) : '—';

    // ROIC using operating invested capital: Assets − Cash − NIBCL
    const ibcl = (Number.isFinite(std)?std:0) + (Number.isFinite(cpltd)?cpltd:0);
    const nibcl = Number.isFinite(cl) ? Math.max(0, cl - ibcl) : NaN;
    const invested = (Number.isFinite(assets)?assets:NaN) - (Number.isFinite(cash)?cash:NaN) - (Number.isFinite(nibcl)?nibcl:NaN);
    const NOPAT = (Number.isFinite(EBIT)?EBIT:NaN) - (Number.isFinite(tax)?tax:NaN);
    const roic = (Number.isFinite(invested) && invested !== 0 && Number.isFinite(NOPAT)) ? (NOPAT / invested) * 100 : NaN;
    g('roicOut').textContent = pct(roic);

    // Growth (4y)
    const growth = (Number.isFinite(Sales) && Number.isFinite(Sales4) && Sales4 !== 0) ? ((Sales / Sales4) - 1) * 100 : NaN;
    g('cumOut').textContent = pct(growth);
    g('cumOut2').textContent = pct(growth);

    // Growth class (simple heuristic)
    const gClass = Number.isFinite(growth) ? (growth >= 150 ? 'Outlier' : (growth >= 60 ? 'Strong' : (growth >= 20 ? 'Moderate' : 'Low'))) : '—';
    g('growthClass').textContent = 'Growth Class: ' + gClass;
    g('growthClass2').textContent = gClass;

    // Spread and verdict
    let spreadText = '—';
    let verdict = 'Needs inputs';
    let reason = 'Provide WACC and compute.';
    if(Number.isFinite(roic) && Number.isFinite(wacc)){
      const spread = roic - wacc;
      spreadText = (spread>=0?'+':'') + spread.toFixed(2) + '%';
      g('spreadOut').textContent = spreadText;
      g('spreadPill').textContent = 'Spread (ROIC – WACC): ' + spreadText;

      // Verdict rule
      if (spread < 0){
        verdict = 'Avoid for now';
        reason = `F‑Score ${getFScoreText()} • Spread ${spreadText} (negative) • Growth ${pct(growth)}`;
        g('notes').textContent = 'ROIC below WACC. Negative spread.';
        g('spreadPill').className = 'pill bad';
      } else {
        verdict = 'Looks investable';
        reason = `F‑Score ${getFScoreText()} • Spread ${spreadText} (positive) • Growth ${pct(growth)}`;
        g('notes').textContent = 'ROIC above WACC. Positive spread.';
        g('spreadPill').className = 'pill good';
      }
    } else {
      g('spreadOut').textContent = '—';
      g('spreadPill').textContent = 'Spread (ROIC – WACC): —';
      g('spreadPill').className = 'pill';
    }
    g('verdict').textContent = verdict;
    g('reason').textContent = reason;

    // Mirror F-score if present
    g('fscoreOut').textContent = getFScoreText();
  }

  function getFScoreText(){
    // Place-holder: if you calculate F-Score elsewhere, set g('fscoreOut') before compute.
    const el = document.getElementById('fscoreInput');
    if (el && el.value !== ''){
      const n = Number(el.value);
      if (Number.isFinite(n)) return n + ' / 9';
    }
    return '—';
  }

  function resetAll(){
    const inputs = [
      'rev0','rev4','ebit','ebitda','tax','cash','std','cpltd','ltd0','termdebt','assets0','cl0','wacc','fscoreInput'
    ];
    inputs.forEach(id=>{const el=g(id); if(el) el.value='';});
    const outs = [
      'ebitMarginOut','ndebtOut','roicOut','cumOut','cumOut2','spreadOut','fscoreOut',
      'growthClass','growthClass2','spreadPill','verdict','reason','notes'
    ];
    outs.forEach(id=>{
      if(id==='spreadPill'){
        g(id).textContent='Spread (ROIC – WACC): —';
        g(id).className = 'pill';
      }else if(id==='growthClass'||id==='growthClass2'){
        g(id).textContent='—';
        if(id==='growthClass') g(id).textContent = 'Growth Class: —';
      }else if(id==='verdict'){
        g(id).textContent='Needs inputs';
      }else if(id==='reason'){
        g(id).textContent='Fetch or fill fields, enter WACC, then press Compute.';
      }else if(id==='notes'){
        g(id).textContent='Enter a WACC to see value creation or destruction.';
      }else{
        g(id).textContent='—';
      }
    });
  }

  // Wire up
  document.getElementById('compute').addEventListener('click', computeSnapshot);
  document.getElementById('reset').addEventListener('click', resetAll);
</script>
</body>
</html>
"""
with open("/mnt/data/index-fixed.html","w",encoding="utf-8") as f:
    f.write(html)
print("Saved /mnt/data/index-fixed.html")
